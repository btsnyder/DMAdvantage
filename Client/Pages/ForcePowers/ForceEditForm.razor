<MudForm Model="@_model" @ref="_form">
    <MudGrid Class="mb-5">
        <MudItem xs="3">
            <MudTextField @bind-Value="@_model.Name" Label="Name" Variant="Variant.Outlined" For="() => _model.Name" Validation="@(_forcePowerValidator.ValidateValue)"/>
        </MudItem>
        <MudItem xs="1">
            <MudNumericField @bind-Value="@_model.Level" Label="Level" Variant="Variant.Outlined" For="() => _model.Level" Validation="@(_forcePowerValidator.ValidateValue)"/>
        </MudItem>
        <MudItem xs="2">
            <MudSelect T="CastingPeriod" @bind-Value="@_model.CastingPeriod" Label="Casting Period" Variant="Variant.Outlined" For="() => _model.CastingPeriod">
                @foreach (var casting in Enum.GetValues<CastingPeriod>())
                {
                    <MudSelectItem Value="@casting">@casting.GetStringValue()</MudSelectItem>
                }
            </MudSelect>
        </MudItem>
        <MudItem xs="2">
            <MudTextField @bind-Value="@_model.CastingDescription" Label="Casting Description" Variant="Variant.Outlined" For="() => _model.CastingDescription"/>
        </MudItem>
        <MudItem xs="2">
            <MudSelect T="PowerRange" @bind-Value="@_model.Range" Label="Range" Variant="Variant.Outlined" For="() => _model.Range">
                @foreach (var range in Enum.GetValues<PowerRange>())
                {
                    <MudSelectItem Value="@range">@range.GetStringValue()</MudSelectItem>
                }
            </MudSelect>
        </MudItem>
        <MudItem xs="2">
            <MudTextField @bind-Value="@_model.RangeDescription" Label="Range Description" Variant="Variant.Outlined" For="() => _model.RangeDescription"/>
        </MudItem>

        <MudItem xs="12">
            <MudTextField @bind-Value="@_model.Description" Label="Description" Variant="Variant.Outlined" Lines="10" For="() => _model.Description"/>
        </MudItem>

        <MudItem xs="2">
            <MudSelect T="ForceAlignment" @bind-Value="@_model.Alignment" Label="Alignment" Variant="Variant.Outlined" For="() => _model.Alignment">
                @foreach (var alignment in Enum.GetValues<ForceAlignment>())
                {
                    <MudSelectItem Value="@alignment">@alignment.GetStringValue()</MudSelectItem>
                }
            </MudSelect>
        </MudItem>
        <MudItem xs="3">
            <MudAutocomplete T="string" Label="Duration" @bind-Value="@_model.Duration" SearchFunc="@DurationSearch" Variant="Variant.Outlined" />
        </MudItem>
        <MudItem xs="2" Class="d-flex justify-center">
            <ToggledText @bind-Value="@_model.Concentration" Text="Concentration" />
        </MudItem>
        <MudItem xs="2">
            <MudSelect @bind-Value="@_model.HitOption" Label="Hit Option" Variant="Variant.Outlined" For="() => _model.HitOption">
                @foreach (var hit in Enum.GetValues<HitOption>())
                {
                    <MudSelectItem Value="@hit">@hit.GetStringValue()</MudSelectItem>
                }
            </MudSelect>
        </MudItem>
        <MudItem xs="3">
            <MudTextField @bind-Value="@_model.HitDescription" Label="Hit Description" Variant="Variant.Outlined" For="() => _model.HitDescription"/>
        </MudItem>

        <MudItem xs="6">
            <MudAutocomplete T="ForcePower" Label="Prerequisite" Variant="Variant.Outlined" ResetValueOnEmptyText="true" 
                Value="@_selectedPrerequisite" ValueChanged="@OnPrerequisiteChange" SearchFunc="@PrerequisiteSearch" 
                ToStringFunc="@(power => power == null ? string.Empty : $"{power.Level} - {power.Name}")"/>
        </MudItem>
        <MudItem xs="6">
            <MudTextField @bind-Value="@_model.Potency" Label="Potency" Variant="Variant.Outlined" For="() => _model.Potency"/>
        </MudItem>

        <Submit @bind-Loading="@_loading" CancelRef="forcepowers" OnClick="OnSubmit"/>
    </MudGrid>
</MudForm>
